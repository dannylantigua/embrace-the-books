{"version":3,"file":"agencyportal-body.js","sources":["../../../Web%20Source/js/solr/solrbatchupdate.js","../../../Web%20Source/lib/infinite-scroll/jquery.infinitescroll.js","../../../Web%20Source/js/ap_turnstile_widget.js"],"names":["update_index","type","$","ajax","url","data","dataType","done","this","substring","indexOf","responseHeader","status","html","ap","core_prompts","description","show","error","jqXHR","window","undefined","infinitescroll","options","callback","element","_create","failed","defaults","loading","finished","finishedMsg","img","msg","msgText","selector","speed","start","state","isDuringAjax","isInvalidPage","isDestroyed","isDone","isPaused","isBeyondMaxPage","currPage","debug","behavior","binder","nextSelector","navSelector","contentSelector","extraScrollPx","itemSelector","animate","pathParse","appendCallback","bufferPx","errorCallback","infid","pixelsFromNavToBottom","path","prefill","maxPage","prototype","_binding","binding","instance","opts","v","call","_debug","unbind","scroll","extend","$window","_validate","attr","_determinepath","Image","src","document","height","offset","top","self","hide","appendTo","proxy","beginAjax","fadeOut","bind","_prefill","Function","console","log","forEach","method","_setup","needsPrefill","Array","slice","arguments","length","toString","match","_error","xhr","_showdonemsg","_loadcallback","box","frag","result","find","children","createDocumentFragment","firstChild","appendChild","get","scrollTo","scrollTop","_nearbottom","pixelsFromWindowBottomToBottom","_pausing","pause","parent","opacity","key","destroy","resume","desturl","condition","is","join","load","responseText","toUpperCase","complete","textStatus","isResolved","success","template","theData","append","retrieve","pageNum","toggle","update","isPlainObject","fn","thisCall","args","each","isFunction","charAt","apply","scrollTimeout","event","special","smartscroll","setup","handler","teardown","execAsap","context","clearTimeout","setTimeout","trigger","jQuery","TurnstileWidget","turnstileServiceURL","refreshTimeout","deletePopoverTemplate","deletePopoverTemplateWithGUID","fileDeleteAction","rowTemplate","rowTemplateWithError","tdTemplateWithError","wiListRowTemplate","wiListRowTemplateError","formsHeading","formsNotProcessedHeading","formsNotRecognizedHeading","formsTemplate","fileListRowTemplate","fileUploaderAlertdivTemplate","showStatusAlertdivTemplate","accountMessageTemplate","lobAlertdivTemplate","spinnerSpan","currentAccountId","spinnerOpts","lines","width","radius","corners","rotate","direction","color","trail","shadow","hwaccel","className","zIndex","left","fileUploadData","widgetOpen","launchUploadWidget","accountId","resetFileuploadSection","modal","remove","processStagedUpload","guid","showLobSelector","deleteStagedItem","requestType","always","turnstileWidget","showUploadStatus","renderUploadStatusTableContent","innerHTML","list","val","tmp","split","fileName","lastUpdateTime","statusDesc","message","popover","on","$popup","next","click","spinner","Spinner","spin","el","e","target","has","updateUploadStatusTableContent","previousMessage","$self","dataGuids","index","button","off","removeAttr","tr","err","consoleInfo","txt","replace","closest","prepend","tmpHtml","formsList","forms","value","errorformsList","notSupportedForms","errorFormsHtml","notRecognizedForms","processLobSelection","environment","isAccountManagementFeatureOn","addProgressIndicatorSpinner","createWorkItems","removeSpinnerControl","cancelLobSelection","fileuploadControlInitialized","setupFileuploaderControls","fileControl","fileDropZone","fileupload","autoUpload","singleFileUploads","acceptFileTypes","dropZone","maxFileSize","files","tmpRow","tmpClass","file","name","push","fileSize","size","Math","round","fileRow","deleteRow","tooltip","progress","parseInt","loaded","total","css","prependAertMessage","tab","addClass","preventDefault","removeClass","resetAccountSearchModal","accountSearchmanager","reset","consoleError","startUpload","tsSelectAccount","createWorkItemsWithAccount","ModalAccountSearchManager","hasClass","ix","splice","filter","submit","createWorkItemsAndAccount","resetAccountModal","continueWithoutAccount","action","accId","tranactions","map","transactions","accountid","renderWorkitemsList","fail","responseJSON","account","workitems","item","lobCd","entityName","workitemid","wiId","lobDesc"],"mappings":"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","sourceRoot":"../","sourcesContent":["function update_index(type) {\n\t// Do post to SolrBatchUpdateServlet with core type\n\t$.ajax({\n\t\ttype: \"POST\",\n\t\turl: \"SolrBatchUpdate\",\n\t\tdata: {type: type},\n\t\tdataType: \"json\"\n\t})\n\t.done(function(data) {\n\t\tvar type = this.data.substring(this.data.indexOf('=')+1);\n\t\tif(data.responseHeader.status == 1) {\n\t\t\t$('#error_messages').html(type + ' ' + ap.core_prompts[\"message.batch.error\"] + data.responseHeader.description).show();\n\t\t}\n\t\telse {\n\t\t\t$('#success_messages').html(type + ' ' + ap.core_prompts[\"message.batch.success\"]).show();\n\t\t}\n\t})\n\t.error(function(jqXHR, data) {\n\t\t$('#error_messages').html(type + ' ' + ap.core_prompts[\"message.batch.error\"] + data.responseHeader.description).show();\n\t});\n}","/*jshint undef: true */\n/*global jQuery: true */\n\n/*\n   --------------------------------\n   Infinite Scroll\n   --------------------------------\n   + https://github.com/paulirish/infinite-scroll\n   + version 2.0b2.120519\n   + Copyright 2011/12 Paul Irish & Luke Shumard\n   + Licensed under the MIT license\n\n   + Documentation: http://infinite-scroll.com/\n*/\n\n(function (window, $, undefined) {\n\t\"use strict\";\n\n    $.infinitescroll = function infscr(options, callback, element) {\n        this.element = $(element);\n\n        // Flag the object in the event of a failed creation\n        if (!this._create(options, callback)) {\n            this.failed = true;\n        }\n    };\n\n    $.infinitescroll.defaults = {\n        loading: {\n            finished: undefined,\n            finishedMsg: \"<em>Congratulations, you've reached the end of the internet.</em>\",\n\t\t\timg: \"data:image/gif;base64,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\",\n            msg: null,\n            msgText: \"<em>Loading the next set of posts...</em>\",\n            selector: null,\n            speed: 'fast',\n            start: undefined\n        },\n        state: {\n            isDuringAjax: false,\n            isInvalidPage: false,\n            isDestroyed: false,\n            isDone: false, // For when it goes all the way through the archive.\n            isPaused: false,\n            isBeyondMaxPage: false,\n            currPage: 1\n        },\n        debug: false,\n\t\tbehavior: undefined,\n        binder: $(window), // used to cache the selector\n        nextSelector: \"div.navigation a:first\",\n        navSelector: \"div.navigation\",\n        contentSelector: null, // rename to pageFragment\n        extraScrollPx: 150,\n        itemSelector: \"div.post\",\n        animate: false,\n        pathParse: undefined,\n        dataType: 'html',\n        appendCallback: true,\n        bufferPx: 40,\n        errorCallback: function () { },\n        infid: 0, //Instance ID\n        pixelsFromNavToBottom: undefined,\n        path: undefined, // Either parts of a URL as an array (e.g. [\"/page/\", \"/\"] or a function that takes in the page number and returns a URL\n\t\tprefill: false, // When the document is smaller than the window, load data until the document is larger or links are exhausted\n        maxPage: undefined // to manually control maximum page (when maxPage is undefined, maximum page limitation is not work)\n\t};\n\n    $.infinitescroll.prototype = {\n\n        /*\t\n            ----------------------------\n            Private methods\n            ----------------------------\n            */\n\n        // Bind or unbind from scroll\n        _binding: function infscr_binding(binding) {\n\n            var instance = this,\n            opts = instance.options;\n\n            opts.v = '2.0b2.120520';\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_binding_'+opts.behavior] !== undefined) {\n                this['_binding_'+opts.behavior].call(this);\n                return;\n            }\n\n            if (binding !== 'bind' && binding !== 'unbind') {\n                this._debug('Binding value  ' + binding + ' not valid');\n                return false;\n            }\n\n            if (binding === 'unbind') {\n                (this.options.binder).unbind('smartscroll.infscr.' + instance.options.infid);\n            } else {\n                (this.options.binder)[binding]('smartscroll.infscr.' + instance.options.infid, function () {\n                    instance.scroll();\n                });\n            }\n\n            this._debug('Binding', binding);\n        },\n\n        // Fundamental aspects of the plugin are initialized\n        _create: function infscr_create(options, callback) {\n\n            // Add custom options to defaults\n            var opts = $.extend(true, {}, $.infinitescroll.defaults, options);\n\t\t\tthis.options = opts;\n\t\t\tvar $window = $(window);\n\t\t\tvar instance = this;\n\n\t\t\t// Validate selectors\n            if (!instance._validate(options)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n            // Validate page fragment path\n            var path = $(opts.nextSelector).attr('href');\n            if (!path) {\n                this._debug('Navigation selector not found');\n                return false;\n            }\n\n            // Set the path to be a relative URL from root.\n            opts.path = opts.path || this._determinepath(path);\n\n            // contentSelector is 'page fragment' option for .load() / .ajax() calls\n            opts.contentSelector = opts.contentSelector || this.element;\n\n            // loading.selector - if we want to place the load message in a specific selector, defaulted to the contentSelector\n            opts.loading.selector = opts.loading.selector || opts.contentSelector;\n\n            // Define loading.msg\n            opts.loading.msg = opts.loading.msg || $('<div id=\"infscr-loading\"><img alt=\"Loading...\" src=\"' + opts.loading.img + '\" /><div>' + opts.loading.msgText + '</div></div>');\n\n            // Preload loading.img\n            (new Image()).src = opts.loading.img;\n\n            // distance from nav links to bottom\n            // computed as: height of the document + top offset of container - top offset of nav link\n            if(opts.pixelsFromNavToBottom === undefined) {\n\t\t\t\topts.pixelsFromNavToBottom = $(document).height() - $(opts.navSelector).offset().top;\n\t\t\t\tthis._debug(\"pixelsFromNavToBottom: \" + opts.pixelsFromNavToBottom);\n\t\t\t}\n\n\t\t\tvar self = this;\n\n            // determine loading.start actions\n            opts.loading.start = opts.loading.start || function() {\n                $(opts.navSelector).hide();\n                opts.loading.msg\n                .appendTo(opts.loading.selector)\n                .show(opts.loading.speed, $.proxy(function() {\n\t\t\t\t\tthis.beginAjax(opts);\n\t\t\t\t}, self));\n            };\n\n            // determine loading.finished actions\n            opts.loading.finished = opts.loading.finished || function() {\n                if (!opts.state.isBeyondMaxPage)\n                    opts.loading.msg.fadeOut(opts.loading.speed);\n            };\n\n\t\t\t// callback loading\n            opts.callback = function(instance, data, url) {\n                if (!!opts.behavior && instance['_callback_'+opts.behavior] !== undefined) {\n                    instance['_callback_'+opts.behavior].call($(opts.contentSelector)[0], data, url);\n                }\n\n                if (callback) {\n                    callback.call($(opts.contentSelector)[0], data, opts, url);\n                }\n\n\t\t\t\tif (opts.prefill) {\n\t\t\t\t\t$window.bind(\"resize.infinite-scroll\", instance._prefill);\n\t\t\t\t}\n            };\n\n\t\t\tif (options.debug) {\n\t\t\t\t// Tell IE9 to use its built-in console\n\t\t\t\tif (Function.prototype.bind && (typeof console === 'object' || typeof console === 'function') && typeof console.log === \"object\") {\n\t\t\t\t\t[\"log\",\"info\",\"warn\",\"error\",\"assert\",\"dir\",\"clear\",\"profile\",\"profileEnd\"]\n\t\t\t\t\t\t.forEach(function (method) {\n\t\t\t\t\t\t\tconsole[method] = this.call(console[method], console);\n\t\t\t\t\t\t}, Function.prototype.bind);\n\t\t\t\t}\n\t\t\t}\n\n            this._setup();\n\n\t\t\t// Setups the prefill method for use\n\t\t\tif (opts.prefill) {\n\t\t\t\tthis._prefill();\n\t\t\t}\n\n            // Return true to indicate successful creation\n            return true;\n        },\n\n\t\t_prefill: function infscr_prefill() {\n\t\t\tvar instance = this;\n\t\t\tvar $window = $(window);\n\n\t\t\tfunction needsPrefill() {\n\t\t\t\treturn (instance.options.contentSelector.height() <= $window.height());\n\t\t\t}\n\n\t\t\tthis._prefill = function() {\n\t\t\t\tif (needsPrefill()) {\n\t\t\t\t\tinstance.scroll();\n\t\t\t\t}\n\n\t\t\t\t$window.bind(\"resize.infinite-scroll\", function() {\n\t\t\t\t\tif (needsPrefill()) {\n\t\t\t\t\t\t$window.unbind(\"resize.infinite-scroll\");\n\t\t\t\t\t\tinstance.scroll();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Call self after setting up the new function\n\t\t\tthis._prefill();\n\t\t},\n\n        // Console log wrapper\n        _debug: function infscr_debug() {\n\t\t\tif (true !== this.options.debug) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (typeof console !== 'undefined' && typeof console.log === 'function') {\n\t\t\t\t// Modern browsers\n\t\t\t\t// Single argument, which is a string\n\t\t\t\tif ((Array.prototype.slice.call(arguments)).length === 1 && typeof Array.prototype.slice.call(arguments)[0] === 'string') {\n\t\t\t\t\tconsole.log( (Array.prototype.slice.call(arguments)).toString() );\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log( Array.prototype.slice.call(arguments) );\n\t\t\t\t}\n\t\t\t} else if (!Function.prototype.bind && typeof console !== 'undefined' && typeof console.log === 'object') {\n\t\t\t\t// IE8\n\t\t\t\tFunction.prototype.call.call(console.log, console, Array.prototype.slice.call(arguments));\n\t\t\t}\n        },\n\n        // find the number to increment in the path.\n        _determinepath: function infscr_determinepath(path) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_determinepath_'+opts.behavior] !== undefined) {\n                return this['_determinepath_'+opts.behavior].call(this,path);\n            }\n\n            if (!!opts.pathParse) {\n\n                this._debug('pathParse manual');\n                return opts.pathParse(path, this.options.state.currPage+1);\n\n            } else if (path.match(/^(.*?)\\b2\\b(.*?$)/)) {\n                path = path.match(/^(.*?)\\b2\\b(.*?$)/).slice(1);\n\n                // if there is any 2 in the url at all.    \n            } else if (path.match(/^(.*?)2(.*?$)/)) {\n\n                // page= is used in django:\n                // http://www.infinite-scroll.com/changelog/comment-page-1/#comment-127\n                if (path.match(/^(.*?page=)2(\\/.*|$)/)) {\n                    path = path.match(/^(.*?page=)2(\\/.*|$)/).slice(1);\n                    return path;\n                }\n\n                path = path.match(/^(.*?)2(.*?$)/).slice(1);\n\n            } else {\n\n                // page= is used in drupal too but second page is page=1 not page=2:\n                // thx Jerod Fritz, vladikoff\n                if (path.match(/^(.*?page=)1(\\/.*|$)/)) {\n                    path = path.match(/^(.*?page=)1(\\/.*|$)/).slice(1);\n                    return path;\n                } else {\n                    this._debug('Sorry, we couldn\\'t parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.');\n                    // Get rid of isInvalidPage to allow permalink to state\n                    opts.state.isInvalidPage = true;  //prevent it from running on this page.\n                }\n            }\n            this._debug('determinePath', path);\n            return path;\n\n        },\n\n        // Custom error\n        _error: function infscr_error(xhr) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_error_'+opts.behavior] !== undefined) {\n                this['_error_'+opts.behavior].call(this,xhr);\n                return;\n            }\n\n            if (xhr !== 'destroy' && xhr !== 'end') {\n                xhr = 'unknown';\n            }\n\n            this._debug('Error', xhr);\n\n            if (xhr === 'end' || opts.state.isBeyondMaxPage) {\n                this._showdonemsg();\n            }\n\n            opts.state.isDone = true;\n            opts.state.currPage = 1; // if you need to go back to this instance\n            opts.state.isPaused = false;\n            opts.state.isBeyondMaxPage = false;\n            this._binding('unbind');\n\n        },\n\n        // Load Callback\n        _loadcallback: function infscr_loadcallback(box, data, url) {\n            var opts = this.options,\n            callback = this.options.callback, // GLOBAL OBJECT FOR CALLBACK\n            result = (opts.state.isDone) ? 'done' : (!opts.appendCallback) ? 'no-append' : 'append',\n            frag;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_loadcallback_'+opts.behavior] !== undefined) {\n                this['_loadcallback_'+opts.behavior].call(this,box,data);\n                return;\n            }\n\n\t\t\tswitch (result) {\n\t\t\t\tcase 'done':\n\t\t\t\t\tthis._showdonemsg();\n\t\t\t\t\treturn false;\n\n\t\t\t\tcase 'no-append':\n\t\t\t\t\tif (opts.dataType === 'html') {\n\t\t\t\t\t\tdata = '<div>' + data + '</div>';\n\t\t\t\t\t\tdata = $(data).find(opts.itemSelector);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'append':\n\t\t\t\t\tvar children = box.children();\n\t\t\t\t\t// if it didn't return anything\n\t\t\t\t\tif (children.length === 0) {\n\t\t\t\t\t\treturn this._error('end');\n\t\t\t\t\t}\n\n\t\t\t\t\t// use a documentFragment because it works when content is going into a table or UL\n\t\t\t\t\tfrag = document.createDocumentFragment();\n\t\t\t\t\twhile (box[0].firstChild) {\n\t\t\t\t\t\tfrag.appendChild(box[0].firstChild);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._debug('contentSelector', $(opts.contentSelector)[0]);\n\t\t\t\t\t$(opts.contentSelector)[0].appendChild(frag);\n\t\t\t\t\t// previously, we would pass in the new DOM element as context for the callback\n\t\t\t\t\t// however we're now using a documentfragment, which doesn't have parents or children,\n\t\t\t\t\t// so the context is the contentContainer guy, and we pass in an array\n\t\t\t\t\t// of the elements collected as the first argument.\n\n\t\t\t\t\tdata = children.get();\n\t\t\t\t\tbreak;\n\t\t\t}\n\n            // loadingEnd function\n            opts.loading.finished.call($(opts.contentSelector)[0],opts);\n\n            // smooth scroll to ease in the new content\n            if (opts.animate) {\n                var scrollTo = $(window).scrollTop() + $(opts.loading.msg).height() + opts.extraScrollPx + 'px';\n                $('html,body').animate({ scrollTop: scrollTo }, 800, function () { opts.state.isDuringAjax = false; });\n            }\n\n            if (!opts.animate) {\n\t\t\t\t// once the call is done, we can allow it again.\n\t\t\t\topts.state.isDuringAjax = false;\n\t\t\t}\n\n            callback(this, data, url);\n\n\t\t\tif (opts.prefill) {\n\t\t\t\tthis._prefill();\n\t\t\t}\n\t\t},\n\n        _nearbottom: function infscr_nearbottom() {\n\n            var opts = this.options,\n            pixelsFromWindowBottomToBottom = 0 + $(document).height() - (opts.binder.scrollTop()) - $(window).height();\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_nearbottom_'+opts.behavior] !== undefined) {\n                return this['_nearbottom_'+opts.behavior].call(this);\n            }\n\n            this._debug('math:', pixelsFromWindowBottomToBottom, opts.pixelsFromNavToBottom);\n\n            // if distance remaining in the scroll (including buffer) is less than the orignal nav to bottom....\n            return (pixelsFromWindowBottomToBottom - opts.bufferPx < opts.pixelsFromNavToBottom);\n\n        },\n\n        // Pause / temporarily disable plugin from firing\n        _pausing: function infscr_pausing(pause) {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_pausing_'+opts.behavior] !== undefined) {\n                this['_pausing_'+opts.behavior].call(this,pause);\n                return;\n            }\n\n            // If pause is not 'pause' or 'resume', toggle it's value\n            if (pause !== 'pause' && pause !== 'resume' && pause !== null) {\n                this._debug('Invalid argument. Toggling pause value instead');\n            }\n\n            pause = (pause && (pause === 'pause' || pause === 'resume')) ? pause : 'toggle';\n\n            switch (pause) {\n                case 'pause':\n                    opts.state.isPaused = true;\n                break;\n\n                case 'resume':\n                    opts.state.isPaused = false;\n                break;\n\n                case 'toggle':\n                    opts.state.isPaused = !opts.state.isPaused;\n                break;\n            }\n\n            this._debug('Paused', opts.state.isPaused);\n            return false;\n\n        },\n\n        // Behavior is determined\n        // If the behavior option is undefined, it will set to default and bind to scroll\n        _setup: function infscr_setup() {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_setup_'+opts.behavior] !== undefined) {\n                this['_setup_'+opts.behavior].call(this);\n                return;\n            }\n\n            this._binding('bind');\n\n            return false;\n\n        },\n\n        // Show done message\n        _showdonemsg: function infscr_showdonemsg() {\n\n            var opts = this.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['_showdonemsg_'+opts.behavior] !== undefined) {\n                this['_showdonemsg_'+opts.behavior].call(this);\n                return;\n            }\n\n            opts.loading.msg\n            .find('img')\n            .hide()\n            .parent()\n            .find('div').html(opts.loading.finishedMsg).animate({ opacity: 1 }, 2000, function () {\n                $(this).parent().fadeOut(opts.loading.speed);\n            });\n\n            // user provided callback when done    \n            opts.errorCallback.call($(opts.contentSelector)[0],'done');\n        },\n\n        // grab each selector option and see if any fail\n        _validate: function infscr_validate(opts) {\n            for (var key in opts) {\n                if (key.indexOf && key.indexOf('Selector') > -1 && $(opts[key]).length === 0) {\n                    this._debug('Your ' + key + ' found no elements.');\n                    return false;\n                }\n            }\n\n            return true;\n        },\n\n        /*\t\n            ----------------------------\n            Public methods\n            ----------------------------\n            */\n\n        // Bind to scroll\n        bind: function infscr_bind() {\n            this._binding('bind');\n        },\n\n        // Destroy current instance of plugin\n        destroy: function infscr_destroy() {\n            this.options.state.isDestroyed = true;\n\t\t\tthis.options.loading.finished();\n            return this._error('destroy');\n        },\n\n        // Set pause value to false\n        pause: function infscr_pause() {\n            this._pausing('pause');\n        },\n\n        // Set pause value to false\n        resume: function infscr_resume() {\n            this._pausing('resume');\n        },\n\n\t\tbeginAjax: function infscr_ajax(opts) {\n\t\t\tvar instance = this,\n\t\t\t\tpath = opts.path,\n\t\t\t\tbox, desturl, method, condition;\n\n\t\t\t// increment the URL bit. e.g. /page/3/\n\t\t\topts.state.currPage++;\n\n            // Manually control maximum page \n            if ( opts.maxPage != undefined && opts.state.currPage > opts.maxPage ){\n                opts.state.isBeyondMaxPage = true;\n                this.destroy();\n                return;\n            }\n\n\t\t\t// if we're dealing with a table we can't use DIVs\n\t\t\tbox = $(opts.contentSelector).is('table, tbody') ? $('<tbody/>') : $('<div/>');\n\n\t\t\tdesturl = (typeof path === 'function') ? path(opts.state.currPage) : path.join(opts.state.currPage);\n\t\t\tinstance._debug('heading into ajax', desturl);\n\n\t\t\tmethod = (opts.dataType === 'html' || opts.dataType === 'json' ) ? opts.dataType : 'html+callback';\n\t\t\tif (opts.appendCallback && opts.dataType === 'html') {\n\t\t\t\tmethod += '+callback';\n\t\t\t}\n\n\t\t\tswitch (method) {\n\t\t\t\tcase 'html+callback':\n\t\t\t\t\tinstance._debug('Using HTML via .load() method');\n\t\t\t\t\tbox.load(desturl + ' ' + opts.itemSelector, undefined, function infscr_ajax_callback(responseText) {\n\t\t\t\t\t\tinstance._loadcallback(box, responseText, desturl);\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'html':\n\t\t\t\t\tinstance._debug('Using ' + (method.toUpperCase()) + ' via $.ajax() method');\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t// params\n\t\t\t\t\t\turl: desturl,\n\t\t\t\t\t\tdataType: opts.dataType,\n\t\t\t\t\t\tcomplete: function infscr_ajax_callback(jqXHR, textStatus) {\n\t\t\t\t\t\t\tcondition = (typeof (jqXHR.isResolved) !== 'undefined') ? (jqXHR.isResolved()) : (textStatus === \"success\" || textStatus === \"notmodified\");\n\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\tinstance._loadcallback(box, jqXHR.responseText, desturl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'json':\n\t\t\t\t\tinstance._debug('Using ' + (method.toUpperCase()) + ' via $.ajax() method');\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\ttype: 'GET',\n\t\t\t\t\t\turl: desturl,\n\t\t\t\t\t\tsuccess: function (data, textStatus, jqXHR) {\n\t\t\t\t\t\t\tcondition = (typeof (jqXHR.isResolved) !== 'undefined') ? (jqXHR.isResolved()) : (textStatus === \"success\" || textStatus === \"notmodified\");\n\t\t\t\t\t\t\tif (opts.appendCallback) {\n\t\t\t\t\t\t\t\t// if appendCallback is true, you must defined template in options.\n\t\t\t\t\t\t\t\t// note that data passed into _loadcallback is already an html (after processed in opts.template(data)).\n\t\t\t\t\t\t\t\tif (opts.template !== undefined) {\n\t\t\t\t\t\t\t\t\tvar theData = opts.template(data);\n\t\t\t\t\t\t\t\t\tbox.append(theData);\n\t\t\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\t\t\tinstance._loadcallback(box, theData);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tinstance._debug(\"template must be defined.\");\n\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// if appendCallback is false, we will pass in the JSON object. you should handle it yourself in your callback.\n\t\t\t\t\t\t\t\tif (condition) {\n\t\t\t\t\t\t\t\t\tinstance._loadcallback(box, data, desturl);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\tinstance._debug(\"JSON ajax request failed.\");\n\t\t\t\t\t\t\tinstance._error('end');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n        // Retrieve next set of content items\n        retrieve: function infscr_retrieve(pageNum) {\n\t\t\tpageNum = pageNum || null;\n\n\t\t\tvar instance = this,\n            opts = instance.options;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['retrieve_'+opts.behavior] !== undefined) {\n                this['retrieve_'+opts.behavior].call(this,pageNum);\n                return;\n            }\n\n            // for manual triggers, if destroyed, get out of here\n            if (opts.state.isDestroyed) {\n                this._debug('Instance is destroyed');\n                return false;\n            }\n\n            // we dont want to fire the ajax multiple times\n            opts.state.isDuringAjax = true;\n\n            opts.loading.start.call($(opts.contentSelector)[0],opts);\n        },\n\n        // Check to see next page is needed\n        scroll: function infscr_scroll() {\n\n            var opts = this.options,\n            state = opts.state;\n\n            // if behavior is defined and this function is extended, call that instead of default\n            if (!!opts.behavior && this['scroll_'+opts.behavior] !== undefined) {\n                this['scroll_'+opts.behavior].call(this);\n                return;\n            }\n\n            if (state.isDuringAjax || state.isInvalidPage || state.isDone || state.isDestroyed || state.isPaused) {\n\t\t\t\treturn;\n\t\t\t}\n\n            if (!this._nearbottom()) {\n\t\t\t\treturn;\n\t\t\t}\n\n            this.retrieve();\n\n        },\n\n        // Toggle pause value\n        toggle: function infscr_toggle() {\n            this._pausing();\n        },\n\n        // Unbind from scroll\n        unbind: function infscr_unbind() {\n            this._binding('unbind');\n        },\n\n        // update options\n        update: function infscr_options(key) {\n            if ($.isPlainObject(key)) {\n                this.options = $.extend(true,this.options,key);\n            }\n        }\n    };\n\n\n    /*\t\n        ----------------------------\n        Infinite Scroll function\n        ----------------------------\n\n        Borrowed logic from the following...\n\n        jQuery UI\n        - https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.widget.js\n\n        jCarousel\n        - https://github.com/jsor/jcarousel/blob/master/lib/jquery.jcarousel.js\n\n        Masonry\n        - https://github.com/desandro/masonry/blob/master/jquery.masonry.js\t\t\n\n*/\n\n    $.fn.infinitescroll = function infscr_init(options, callback) {\n\n\n        var thisCall = typeof options;\n\n        switch (thisCall) {\n\n            // method \n            case 'string':\n                var args = Array.prototype.slice.call(arguments, 1);\n\n\t\t\t\tthis.each(function () {\n\t\t\t\t\tvar instance = $.data(this, 'infinitescroll');\n\n\t\t\t\t\tif (!instance) {\n\t\t\t\t\t\t// not setup yet\n\t\t\t\t\t\t// return $.error('Method ' + options + ' cannot be called until Infinite Scroll is setup');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!$.isFunction(instance[options]) || options.charAt(0) === \"_\") {\n\t\t\t\t\t\t// return $.error('No such method ' + options + ' for Infinite Scroll');\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t// no errors!\n\t\t\t\t\tinstance[options].apply(instance, args);\n\t\t\t\t});\n\n            break;\n\n            // creation \n            case 'object':\n\n                this.each(function () {\n\n                var instance = $.data(this, 'infinitescroll');\n\n                if (instance) {\n\n                    // update options of current instance\n                    instance.update(options);\n\n                } else {\n\n                    // initialize new instance\n                    instance = new $.infinitescroll(options, callback, this);\n\n                    // don't attach if instantiation failed\n                    if (!instance.failed) {\n                        $.data(this, 'infinitescroll', instance);\n                    }\n\n                }\n\n            });\n\n            break;\n\n        }\n\n        return this;\n    };\n\n\n\n    /* \n     * smartscroll: debounced scroll event for jQuery *\n     * https://github.com/lukeshumard/smartscroll\n     * Based on smartresize by @louis_remi: https://github.com/lrbabe/jquery.smartresize.js *\n     * Copyright 2011 Louis-Remi & Luke Shumard * Licensed under the MIT license. *\n     */\n\n    var event = $.event,\n    scrollTimeout;\n\n    event.special.smartscroll = {\n        setup: function () {\n            $(this).bind(\"scroll\", event.special.smartscroll.handler);\n        },\n        teardown: function () {\n            $(this).unbind(\"scroll\", event.special.smartscroll.handler);\n        },\n        handler: function (event, execAsap) {\n            // Save the context\n            var context = this,\n            args = arguments;\n\n            // set correct event type\n            event.type = \"smartscroll\";\n\n            if (scrollTimeout) { clearTimeout(scrollTimeout); }\n            scrollTimeout = setTimeout(function () {\n                $(context).trigger('smartscroll', args);\n            }, execAsap === \"execAsap\" ? 0 : 100);\n        }\n    };\n\n    $.fn.smartscroll = function (fn) {\n        return fn ? this.bind(\"smartscroll\", fn) : this.trigger(\"smartscroll\", [\"execAsap\"]);\n    };\n\n\n})(window, jQuery);\n","\r\n\r\nvar ap = ap || {};\r\n\r\n\r\n/**\r\n * Agencyport Turnstile widget manager.  \r\n */\r\nap.TurnstileWidget = function () {\r\n\r\n    \"use strict\";\r\n\t/**\r\n\t* Service URL for Turnstile file upload.\r\n\t*/\r\n    var turnstileServiceURL = \"FileUploadServlet\";\r\n    \r\n    /**\r\n     * time interval for seeking new updates from server while there are queued items in the list\r\n     */\r\n    this.refreshTimeout = 3000;\r\n    \r\n    /**\r\n     * Delete pop over template.\r\n     */\r\n    var deletePopoverTemplate = \"<p>Are you sure you want to delete this?</p> \" +\r\n\t\"<div class='btn-group'>\" + \r\n\t\t\"<button type='button' class='btn btn-primary ok' >Yes</button>\" + \r\n\t\t\"<button type='button' class='btn btn-default cancel' >No</button>\" + \r\n\t\"</div>\";\r\n\r\n    var deletePopoverTemplateWithGUID = \"<p>Are you sure you want to delete this?</p> \" +\r\n\t\"<div class='btn-group'>\" + \r\n\t\t\"<button type='button' class='btn btn-primary ok' id='{{BGUID}}'>Yes</button>\" + \r\n\t\t\"<button type='button' class='btn btn-default cancel' >No</button>\" + \r\n\t\"</div>\";\r\n    /**\r\n     * File Delete button, click on this will trigger a confirmation pop over to be displayed.\r\n     */\r\n    var fileDeleteAction = '<button type=\"button\" class=\"btn btn-default delete-popover\"  data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n    \t\t\t\t\t\t'data-content=\"' + deletePopoverTemplate + '\">' + ap.core_prompts[\"action.Delete\"] + '</button>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for files .\r\n     */\r\n    var rowTemplate = '<tr data-guid={{GUID}} ><td>{{formName}}</td><td>{{lastUpdated}}</td>' +\r\n        '<td> <button type=\"button\" class=\"btn btn-primary\" {{disabled}} data-dismiss=\"modal\" > <span  class=\"pull-left status-descr\" >{{status}}</span>{{spinner-container}}</button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td></tr>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for files with error.\r\n     */\r\n    var rowTemplateWithError = '<tr data-guid={{GUID}} ><td>{{formName}}</td><td>{{lastUpdated}}</td>' +\r\n        '<td> <button type=\"button\" class=\"btn btn-primary error-close\"  aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"bottom\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"{{error_message}}\"><span  class=\"pull-left status-descr\" >{{status}}</span></button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td></tr>';\r\n   \r\n    /**\r\n     * Table Row template for files with error.\r\n     */\r\n    var tdTemplateWithError = '<td>{{formName}}</td><td>{{lastUpdated}}</td>' +\r\n        '<td> <button type=\"button\" class=\"btn btn-primary error-close\"  aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"bottom\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"{{error_message}}\"><span  class=\"pull-left status-descr\" >{{status}}</span></button></td>' +\r\n        '<td> <button type=\"button\" class=\"close\" aria-hidden=\"true\"   data-toggle=\"popover\" data-placement=\"left\" data-html=\"true\" ' +\r\n        '\t\t\tdata-content=\"' + deletePopoverTemplateWithGUID + '\"><i class=\"fa\"></i></button></td>';\r\n   \r\n    /**\r\n     * Table Row template for workitems listing .\r\n     */\r\n    var wiListRowTemplate = '<tr class=\"{{styleClass}}\" ><td>{{workItemId}}</td> <td> {{lobTitle}}</td><td>  {{url}} </td></tr>';\r\n    \r\n    \r\n    /**\r\n     * Table Row template for workitems listing .\r\n     */\r\n    var wiListRowTemplateError = '<tr class=\"{{styleClass}}\" ><td>{{workItemId}}</td> <td> {{lobTitle}}</td><td><button type=\"button\" class=\"btn btn-default error-close\" aria-hidden=\"true\" data-toggle=\"popover\" data-placement=\"bottom\" data-html=\"true\" ' +\r\n    \t\t\t'data-content=\"{{error}}\"><span  class=\"pull-left status-descr\">' + ap.core_prompts[\"action.Error\"] + '</span></button></td></tr>';\r\n\r\n    /**\r\n     * Header section for Forms Processed.\r\n     */\r\n    var formsHeading = '<div class=\"list-group-item\"><h4 class=\"list-group-item-heading\">' + ap.core_prompts[\"header.Title.FormsProcesses\"] + '</h4></div>';\r\n\r\n    /**\r\n     * Header section for Forms Not Processed.\r\n     */\r\n    var formsNotProcessedHeading =\t'<div class=\"list-group-item\">'\r\n    \t\t\t\t\t\t\t+\t'<h4 class=\"list-group-item-heading toggler forms-not-processed\">'\r\n    \t\t\t\t\t\t\t+\t'<a data-toggle=\"collapse\" data-target=\".unprocessed-forms\" href=\"#unprocessed-forms\" class=\"collapsed\">'\r\n    \t\t\t\t\t\t\t+\t'<i class=\"fa\"></i><span>Forms Not Processed</span></a>'\r\n    \t\t\t\t\t\t\t+\t'</h4>'\r\n    \t\t\t\t\t\t\t+\t'<div id=\"unprocessed-forms\" class=\"collapse unprocessed-forms\">{{formsList}}</div>'\r\n    \t\t\t\t\t\t\t+\t'</div>';\r\n    \r\n    /**\r\n     * Header section for Forms Not Processed.\r\n     */\r\n    var formsNotRecognizedHeading =\t'<div class=\"list-group-item\">'\r\n    \t\t\t\t\t\t\t+\t'<h4 class=\"list-group-item-heading toggler forms-not-processed\">'\r\n    \t\t\t\t\t\t\t+\t'<a data-toggle=\"collapse\" data-target=\".unprocessed-forms\" href=\"#unprocessed-forms\" class=\"collapsed\">'\r\n    \t\t\t\t\t\t\t+\t'<i class=\"fa\"></i><span>Pages Not Recognized</span></a>'\r\n    \t\t\t\t\t\t\t+\t'</h4>'\r\n    \t\t\t\t\t\t\t+\t'<div id=\"unprocessed-forms\" class=\"collapse unprocessed-forms\">{{formsList}}</div>'\r\n    \t\t\t\t\t\t\t+\t'</div>';\r\n    \r\n    /**\r\n     * repeating template for the list of forms\r\n     */\r\n    var formsTemplate = '<div class=\"list-group-item\">{{formId}}</div>';\r\n\r\n    /**\r\n     * File List Row template.. the table row that displays the file name, size and delete action.\r\n     */\r\n\tvar fileListRowTemplate = '<tr {{class}} ><td class=\"file-name\">{{fileName}}</td><td class=\"file-size\">{{fileSize}}</td><td class=\"file-action\">{{action}}</td></tr>';\r\n\t\r\n\t/**\r\n\t * Alert template for file validation\r\n\t */\r\n\tvar fileUploaderAlertdivTemplate = '<div id=\"file-uploader-validation-message\" class=\"alert alert-danger\">{{message}}</div>';\r\n\t\r\n\t/**\r\n\t * Alert template for status view\r\n\t */\r\n\tvar showStatusAlertdivTemplate = '<div id=\"show-status-validation-message\" class=\"alert alert-danger\">{{message}}</div>';\r\n\t\r\n\tvar accountMessageTemplate = '<span>Your forms have been submitted successfully to the account <b>{{accountName}}</b>.</span>'; \r\n\t/**\r\n\t * Lob Alert template, shown when there is no lob selected.\r\n\t */\r\n\tvar lobAlertdivTemplate = '<div id=\"lob-validation-message\" class=\"alert alert-danger\">{{message}}</div>';\r\n\t \r\n\t\r\n\tvar spinnerSpan = $('<span class=\"pull-right spinner-container\"></span>') ;\r\n\t\r\n\t\r\n\t/**\r\n\t * Currently selected account ID , set from call back of search results.\r\n\t */\r\n\tthis.currentAccountId = null ;\r\n\t\r\n\t/**\r\n\t * Progress Spinnner widget options.\r\n\t */\r\n\tvar spinnerOpts = {\r\n\t\t\t  lines: 8, // The number of lines to draw\r\n\t\t\t  length: 3, // The length of each line\r\n\t\t\t  width: 4, // The line thickness\r\n\t\t\t  radius: 2, // The radius of the inner circle\r\n\t\t\t  corners: 1, // Corner roundness (0..1)\r\n\t\t\t  rotate: 0, // The rotation offset\r\n\t\t\t  direction: 1, // 1: clockwise, -1: counterclockwise\r\n\t\t\t  color: '#fff', // #rgb or #rrggbb or array of colors\r\n\t\t\t  speed: 1, // Rounds per second\r\n\t\t\t  trail: 20, // Afterglow percentage\r\n\t\t\t  shadow: false, // Whether to render a shadow\r\n\t\t\t  hwaccel: false, // Whether to use hardware acceleration\r\n\t\t\t  className: 'spinner', // The CSS class to assign to the spinner\r\n\t\t\t  zIndex: 2e9, // The z-index (defaults to 2000000000)\r\n\t\t\t  top: '50%', // Top position relative to parent\r\n\t\t\t  left: '90%' // Left position relative to parent\r\n\t\t\t};\r\n\t\r\n\t/**\r\n\t* File upload Data - blueimp object that holds on to the files that are selected\r\n\t* for uploading.\r\n\t* <code>files</code> holds the files list after a process is applied.\r\n\t*/\r\n\tthis.fileUploadData = null;\r\n\t\r\n\tthis.widgetOpen = false;\r\n\t/**\r\n\t * Launch the Turnstile upload widget - Launch point is generally global.\r\n\t * @param accountId  - optional parameter. if present, this has to be a valid account number. \r\n\t * \tuploaded workitems will be associated with the selected account, identified by the accountID.\r\n\t */\r\n\tthis.launchUploadWidget = function ( accountId ) {\r\n\t\tthis.resetFileuploadSection();\r\n\t\t$(\"#turnstile-upload-widget\").modal('show');\r\n\t\t\r\n\t\tthis.currentAccountId = accountId ? accountId : null ; // Note that accountId can be undefined, this condition is utilized when account association decision is made.\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * File upload section reset. \r\n\t */\r\n\tthis.resetFileuploadSection = function (){\r\n\t\t\r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", false);\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\r\n\t\t$(\"#fileupload-file-listing\").html('');\r\n\t\t\r\n\t\tthis.fileUploadData = null;\r\n\t};\r\n\r\n \r\n\t\r\n    /**\r\n     * Process the Staged Upload item, Default implementation opens the LOB Transaction list.\r\n     * should a different workflow is desired, override this function and apply your processing logic.  \r\n     * @param guid - the guid associated with the staged item.\r\n     */\r\n    this.processStagedUpload = function(guid){\r\n    \tthis.showLobSelector(guid); \r\n    };\r\n    \r\n \r\n    /**\r\n     * Delete a staged item.\r\n     */\r\n    this.deleteStagedItem = function (guid) {\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: turnstileServiceURL,\r\n            dataType: \"JSON\",\r\n            data: {\r\n                'requestType': \"delete\",\r\n                'guid': guid\r\n            }\r\n        }).always(function () {\r\n                ap.turnstileWidget.showUploadStatus();\r\n           });\r\n    };\r\n\r\n\t\r\n    \r\n    this.renderUploadStatusTableContent = function ( msg ){\r\n\r\n        var innerHTML = '';\r\n        \r\n        msg.list.forEach( function (val, index ) {\r\n    \r\n            if(val.status != 4 ){\r\n            \tvar tmp = rowTemplate;\r\n            \tinnerHTML += tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n            \t.split(\"{{disabled}}\").join(val.status == 3 ? 'onclick=\"ap.turnstileWidget.processStagedUpload(\\'{{GUID}}\\')\"' : 'disabled')\r\n            \t.split(\"{{spinner-container}}\").join( (val.status == 1 || val.status == 2) ? '<span class=\"pull-right spinner-container\"></span> ' : '')\r\n            \t.split(\"{{status}}\").join(val.statusDesc)\r\n            \t.split(\"{{GUID}}\").join(val.guid)\r\n            \t.split(\"{{BGUID}}\").join(val.guid);\r\n            }else{\r\n            \tvar tmp = rowTemplateWithError;\r\n            \tinnerHTML += tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n            \t.split(\"{{error_message}}\").join(val.message)\r\n            \t.split(\"{{GUID}}\").join(val.guid)\r\n            \t.split(\"{{BGUID}}\").join(val.guid)\r\n            \t.split(\"{{status}}\").join(val.statusDesc);\r\n            }\r\n        });\r\n        \r\n       \r\n        $('#turnstile-report-table').html(innerHTML);\r\n        \r\n        \r\n        // Set up the pop over on the close button.\r\n        $('#turnstile-report-table .close').popover()\r\n            .on('shown.bs.popover', function () {\r\n                var $popup = $(this);\r\n                $(this).next('.popover').find('button.cancel').click(function (e) {\r\n                    $popup.popover('hide');\r\n                });\r\n                $(this).next('.popover').find('button.ok').click(function (e) {\r\n                    $popup.popover('hide');\r\n                    ap.turnstileWidget.deleteStagedItem($(this).attr(\"id\"));\r\n                });\r\n\t\t\t});\r\n        \r\n        var spinner = new Spinner(spinnerOpts).spin();\r\n        $('#turnstile-report-table button .spinner-container').append(spinner.el);\r\n        \r\n        $(\"#turnstile-report-table\").find('[data-toggle=\"popover\"]').each(function () {\r\n            $(this).popover('show');\r\n            $(this).popover('hide');\r\n        });\r\n        \r\n        //close popover while clicking outside\r\n        $('body').on('click', function (e) {\r\n            $('[data-toggle=\"popover\"]').each(function () {\r\n                if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\r\n                    $(this).popover('hide');\r\n                }\r\n            });\r\n        });\r\n   \r\n    };\r\n    \r\n    \r\n    this.updateUploadStatusTableContent = function (msg, previousMessage) {\r\n    \t\r\n    \t//check the existing items\r\n    \tvar $self = this;\r\n    \tvar dataGuids = $('#turnstile-report-table').find('tr[data-guid]');\r\n    \tif(dataGuids.length != msg.list.length){\r\n    \t\t$self.renderUploadStatusTableContent(msg);\r\n    \t\treturn;   \r\n    \t}\r\n    \t\r\n        msg.list.forEach( function (val, index ) {\r\n        \t// Previous and current GUID matches - indicating that the indexed element on the list has not changed\r\n        \t// this would mean - we can check the status and call for update if needed. \r\n        \ttry{\r\n        \t\tif( val.guid === previousMessage.list[index].guid ){\r\n        \t\t\tif( val.status != previousMessage.list[index].status ){\r\n\r\n        \t\t\t\tvar button = $('#turnstile-report-table tr:eq('+ index +') .btn-primary');\r\n        \t\t\t\tbutton.find('.status-descr').html(val.statusDesc); \r\n\r\n        \t\t\t\tif(val.status == 3){\r\n        \t\t\t\t\tbutton.find('.spinner-container').remove();\r\n        \t\t\t\t\tbutton.off('click');\r\n        \t\t\t\t\tbutton.on('click', function ( ){ ap.turnstileWidget.processStagedUpload( val.guid );});\r\n        \t\t\t\t\tbutton.removeAttr('disabled');\r\n        \t\t\t\t}else{        \t\t\t\t\r\n        \t\t\t\t\tvar tr = $('#turnstile-report-table tr:eq('+ index +')');\r\n        \t\t\t\t\tvar tmp = tdTemplateWithError;\r\n        \t\t\t\t\tvar innerHTML =  tmp.split(\"{{formName}}\").join(val.fileName).split(\"{{lastUpdated}}\").join(val.lastUpdateTime)\r\n        \t\t\t\t\t.split(\"{{error_message}}\").join(val.message)\r\n        \t\t\t\t\t.split(\"{{GUID}}\").join(val.guid)\r\n        \t\t\t\t\t.split(\"{{BGUID}}\").join(val.guid)\r\n        \t\t\t\t\t.split(\"{{status}}\").join(val.statusDesc);\r\n\r\n        \t\t\t\t\ttr.html(innerHTML);\r\n        \t\t\t\t\t$(\"#turnstile-report-table\").find('[data-toggle=\"popover\"]').each(function () {\r\n        \t\t\t\t\t\t$(this).popover('show');\r\n        \t\t\t\t\t\t$(this).popover('hide');\r\n        \t\t\t\t\t});\r\n\r\n        \t\t\t\t\t// Set up the pop over on the close button.\r\n        \t\t\t\t\t$('#turnstile-report-table .close').popover()\r\n        \t\t\t\t\t.on('shown.bs.popover', function () {\r\n        \t\t\t\t\t\tvar $popup = $(this);\r\n        \t\t\t\t\t\t$(this).next('.popover').find('button.cancel').click(function (e) {\r\n        \t\t\t\t\t\t\t$popup.popover('hide');\r\n        \t\t\t\t\t\t});\r\n        \t\t\t\t\t\t$(this).next('.popover').find('button.ok').click(function (e) {\r\n        \t\t\t\t\t\t\t$popup.popover('hide');\r\n        \t\t\t\t\t\t\tap.turnstileWidget.deleteStagedItem($(this).attr(\"id\"));\r\n        \t\t\t\t\t\t});\r\n        \t\t\t\t\t});\r\n        \t\t\t\t}\r\n        \t\t\t}\r\n        \t\t}else{\r\n        \t\t\t// GUID does not match - abort update operation - call for full re-render.\r\n        \t\t\t// Not attempting to salvage the table etc as it could be more expensive operation to perform.\r\n        \t\t\t$self.renderUploadStatusTableContent(msg);\r\n        \t\t\treturn;  // no point in continuing with loop execution. \r\n        \t\t}\r\n        \t}catch(err){\r\n        \t\t$self.renderUploadStatusTableContent(msg);\r\n        \t\treturn;   \r\n        \t}\r\n        });\r\n        \r\n    };\r\n   \r\n    \r\n    /**\r\n     * Show upload status -  displays the modal dialog with the latest TS processing progress information,\r\n     * \r\n     */\r\n    this.showUploadStatus = function ( previousMessage) {\r\n    \t\r\n    \tvar $self = this; \r\n    \t\r\n    \t$(\"#show-status-validation-message\").remove();\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: turnstileServiceURL,\r\n            dataType: \"JSON\",\r\n            data: {\r\n                'requestType': \"list\"\r\n            }\r\n        }).done(function (msg) {\r\n        \tap.consoleInfo(\"Turnstile Status Message status \" + msg.status);\r\n            if (msg.status === 'success') {\r\n\r\n            \tif(previousMessage){\r\n            \t\t\r\n            \t\t$self.updateUploadStatusTableContent(msg, previousMessage);\r\n            \t\t\r\n            \t}else{\r\n                \t// Render the list\r\n                \t$self.renderUploadStatusTableContent(msg);\r\n            \t\t\r\n            \t}\r\n            \tvar txt = $('a[href=\"#turnstile-file-upload-status\"]').html();\r\n            \tif(msg.list.length){\r\n                \t\r\n                \t\r\n                \t$('a[href=\"#turnstile-file-upload-status\"]').html( txt.replace( /\\s\\((\\d+)\\)/, \"\") + \" (\" + msg.list.length +\")\" ); \r\n                \t$('#upload-status-count').html(msg.list.length);\r\n                }else{\r\n                \t \r\n                \t$('a[href=\"#turnstile-file-upload-status\"]').html( txt.replace( /\\s\\((\\d+)\\)/, \"\") ); \r\n                \t$('#upload-status-count').html(\"\");\r\n                \t$('#turnstile-report-table').html(\"<tr><td>\" + ap.core_prompts[\"label.Template.NoUploadForms\"] + \"</td></tr>\");\r\n                }\r\n            \t\r\n            \t if($self.widgetOpen){                \r\n                 \tsetTimeout( function(){ $self.showUploadStatus( msg );}, $self.refreshTimeout);                     \r\n                 }else{\r\n                 \tap.consoleInfo('Turnstile widget is closed. Stop updating Turnstile upload status.');\r\n                 }\r\n            \t                \r\n            }\r\n            if(msg.status === 'error'){\r\n            \t$('#turnstile-report-table').closest('table').prepend(\r\n            \t\t\tshowStatusAlertdivTemplate.split('{{message}}').join(msg.message) \r\n            \t\t\t);\r\n            }\r\n            \r\n        });\r\n        \r\n    };\r\n\r\n    /**\r\n     * Display the LOB selector modal.\r\n     */\r\n    this.showLobSelector = function (guid) {\r\n\r\n    \t$('#turnstile-stage-guid').val(\"\");\r\n\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: turnstileServiceURL,\r\n            dataType: \"JSON\",\r\n            data: {\r\n                'requestType': \"forms\",\r\n                'guid': guid\r\n            }\r\n        })\r\n        .done(function (data) {\r\n        \tap.consoleInfo(data);\r\n            var tmpHtml = formsHeading;\r\n            var formsList = data.forms.split(\",\");\r\n\r\n            $.each(formsList, function (key, value) {\r\n                tmpHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n            });\r\n\r\n            $('#forms-list').html(tmpHtml);\r\n\r\n            $('#turnstile-transaction-list input[type=\"checkbox\"]').attr('checked', false);\r\n            $('#lob-validation-message').remove();\r\n            $('#turnstile-lob-selector').modal();\r\n            $('#turnstile-stage-guid').val(guid);\r\n            \r\n            //form not processed           \r\n            tmpHtml = formsNotProcessedHeading;\r\n            var errorformsList = data.notSupportedForms.split(\",\");\r\n            var errorFormsHtml = \"\";\r\n            if(errorformsList[0].length == 0){\r\n            \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(\"None\");\r\n            }else{\r\n                $.each(errorformsList, function (key, value) {\r\n                \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n                });            \t\r\n            }\r\n            tmpHtml = tmpHtml.replace(\"{{formsList}}\", errorFormsHtml);\r\n            $('#error-forms-list').html(tmpHtml);\r\n            \r\n            tmpHtml = formsNotRecognizedHeading;\r\n            errorformsList = data.notRecognizedForms.split(\",\");\r\n            errorFormsHtml = \"\";\r\n            if(errorformsList[0].length == 0){\r\n            \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(\"None\");\r\n            }else{\r\n                $.each(errorformsList, function (key, value) {\r\n                \terrorFormsHtml += formsTemplate.split(\"{{formId}}\").join(value);\r\n                });            \t\r\n            }\r\n            tmpHtml = tmpHtml.replace(\"{{formsList}}\", errorFormsHtml);\r\n            $('#unknown-forms-list').html(tmpHtml);\r\n            \r\n        });\r\n\r\n    };\r\n    \r\n    \r\n    /**\r\n     * Process the Continue of LOB Selection  \r\n     * Override if the workflow needs to be altered. \r\n     */\r\n    this.processLobSelection = function (){\r\n    \t\r\n    \t \r\n    \tvar $self = this;\r\n    \t// Validate that at least one transaction is selected. \r\n    \tif(!$('input[name=\"transactions\"]:checked').length){\r\n    \t\t$(\"#turnstile-lob-selector .modal-body\").prepend( lobAlertdivTemplate.split(\"{{message}}\").join(ap.core_prompts[\"prompt.Template.SelectLOB\"]) );\t\r\n    \t\treturn false;\r\n    \t}\r\n    \t\r\n    \t$('#lob-validation-message').remove();\r\n    \t\r\n    \tif(ap.environment.isAccountManagementFeatureOn){\r\n    \t\r\n    \t\t// Move on to the Account Modals. \r\n    \t\t$('#turnstile-lob-selector').modal('hide');\r\n        \t\r\n    \t\t// if self has an account number, then skip the account number selection. create workitems and \r\n    \t\t// associate with account at hand. \r\n    \t\tif( $self.currentAccountId != null ){\r\n    \t\t\t\r\n    \t\t\t$self.addProgressIndicatorSpinner($('#turnstile-lob-selector button.continue'));\r\n    \t    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t    \t\r\n    \t\t\t// provide call back to hide the modal\r\n    \t\t\tthis.createWorkItems(function(){ \r\n    \t\t\t\t\t$self.removeSpinnerControl($('#turnstile-lob-selector button.continue'));\r\n    \t\t\t\t\t$('#turnstile-lob-selector').modal('hide');\r\n    \t\t\t\t\t$self.currentAccountId = null ; // setting back to null.\r\n    \t\t\t\t}, $self.currentAccountId );\r\n    \t\t}else{\r\n        \t\t// Move on to the Account Modals. \r\n        \t\t$('#turnstile-lob-selector').modal('hide');\r\n            \t$('#turnstile-account-selector').modal('show');\r\n    \t\t}\r\n        \t\r\n    \t}else{ \r\n    \t\t\r\n    \t\t// Set up the spinner and wait for the processing to finish up.\r\n    \t\t$self.addProgressIndicatorSpinner($('#turnstile-lob-selector button.continue'));\r\n        \t\r\n        \t$('#turnstile-lob-selector button').attr(\"disabled\", \"disabled\");\r\n        \t\r\n        \tthis.createWorkItems( function() {\r\n        \t\t\t\t$('#turnstile-lob-selector').modal('hide');\r\n        \t\t\t\t$('#turnstile-lob-selector button').removeAttr(\"disabled\");\r\n        \t\t\t\t\r\n        \t\t\t\t$self.removeSpinnerControl($('#turnstile-lob-selector button.continue'));\r\n        \t\t\t});\r\n    \t}\r\n    \t\r\n    \t\r\n    };\r\n    \r\n    /**\r\n     * appends a progress indicator spinner control to the jQuery element object passed in.\r\n     * @param element - jQuery Element on which the spinner is to be attached.\r\n     */\r\n    this.addProgressIndicatorSpinner = function(element){\r\n       \tvar spinner = new Spinner(spinnerOpts).spin();\r\n    \tspinnerSpan.append(spinner.el);\r\n    \telement.append(spinnerSpan);\r\n    };\r\n    \r\n    /**\r\n     * Removes a spiner from an element. \r\n     * @param element - object on which the spinner is attached.\r\n     */\r\n    this.removeSpinnerControl = function(element){\r\n    \telement.find('.spinner-container').remove();\r\n    }; \r\n    \r\n    /**\r\n     * Process cancel action. brings the user back to the status page.\r\n     */\r\n    this.cancelLobSelection = function() {\r\n    \tthis.launchUploadWidget( this.currentAccountId);\r\n    };\r\n    \r\n    \r\n    \r\n    /**\r\n     * Indicates if the file upload control has been initialized for the page or not, will be set to true on first access.\r\n     */\r\n    this.fileuploadControlInitialized = false ;\r\n    \r\n    /**\r\n     * The file uploader ( blue imp ) library setup \r\n     * The file uploader control initialization is done only on modal dialog access. \r\n     */\r\n    this.setupFileuploaderControls = function ( fileControl, fileDropZone) {\r\n    \tif( !this.fileuploadControlInitialized ) {\r\n    \t\tthis.fileuploadControlInitialized = true;\r\n\r\n    \t\tvar $self = this ;\r\n    \t\t/*\r\n    \t\t * setup blue-imp library\r\n    \t\t */\t\t\r\n    \t\t$('#'+fileControl).fileupload({\r\n    \t\t\turl: turnstileServiceURL,\r\n    \t\t\tdataType: 'json',\r\n    \t\t\tautoUpload: false,\r\n    \t\t\tsingleFileUploads: false,\r\n    \t\t\tacceptFileTypes: /(\\.|\\/)(tiff|pdf|zip)$/i,\r\n    \t\t\tdropZone : $('#' + fileDropZone),\r\n    \t\t\tmaxFileSize: 15000000} //15 MB\r\n    \t\t).on('fileuploadadd', function (e, data) {\r\n    \t\t\t\r\n    \t\t\t$('#file-uploader-validation-message').remove();\r\n    \t\t\t\r\n    \t\t\tif(null === $self.fileUploadData ){\r\n    \t\t\t\t\r\n    \t\t\t\t$self.fileUploadData = $.extend({},data);\r\n    \t\t\t\t$self.fileUploadData.files = [];\r\n    \t\t\t}\r\n    \t\t\t  \r\n    \t\t}).on('fileuploadprocessalways', function (e, data) {\r\n    \t\t\t\r\n    \t\t\tvar file = data.files[data.index];\r\n    \t\t\tvar tmpRow, tmpClass, fileName = '';\r\n    \t\t\t\r\n    \t\t\tif(file.error){\r\n    \t\t\t\tfileName = '<i class=\"fa fa-exclamation-triangle\"  data-toggle=\"tooltip\" data-placement=\"top\" title=\"'+file.error+'\" ></i> '+file.name;\r\n    \t\t\t\ttmpClass = 'class=\"danger\"';\r\n    \t\t\t}else{\r\n    \t\t\t\tfileName = file.name;\r\n    \t\t\t}\r\n    \t\t\t\r\n    \t\t\t$self.fileUploadData.files.push(file);\r\n    \t\t\t\r\n    \t\t\tvar  fileSize = \"\";\r\n    \t\t\tif(file && file.size ){\r\n    \t\t\t\tfileSize = Math.round(file.size / 1024) + ' Kb';\r\n    \t\t\t}\r\n    \t\t\ttmpRow = fileListRowTemplate.split(\"{{fileName}}\").join(fileName)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{fileSize}}\").join(fileSize)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{class}}\").join(tmpClass)\r\n    \t\t\t\t\t\t\t\t\t\t.split(\"{{action}}\").join(fileDeleteAction);\r\n    \t\t\t\r\n    \t\t\t\r\n    \t\t\tvar fileRow = $(tmpRow);\r\n    \t\t\t\r\n    \t\t\t\r\n    \t\t\t// Initialize the delete pop over and tool tip\r\n    \t\t\tfileRow.find('button').popover()\r\n    \t\t\t\t.on('shown.bs.popover', function () {\r\n    \t\t\t\t\tvar $popup = $(this);\r\n    \t\t\t\t\t$(this).next('.popover').find('button.cancel').click(function (e) {\r\n                        $popup.popover('hide');\r\n    \t\t\t\t});\r\n                    $(this).next('.popover').find('button.ok').click(function (e) {\r\n                        $popup.popover('hide');\r\n                        ap.turnstileWidget.deleteRow(fileRow);\r\n                    });\r\n    \t\t\t});\r\n    \t\t\t\r\n    \t\t\tfileRow.find('.fa-exclamation-triangle').tooltip();\t\t\r\n    \t\t\t\r\n    \t\t\t$(\"#fileupload-file-listing\").append(fileRow);\r\n    \t\r\n    \t\t\t\r\n    \t\t}).on('fileuploadprogressall',function (e, data) {\r\n    \t\t\t\r\n    \t\t\t var progress = parseInt(data.loaded / data.total * 100, 10);\r\n    \t\t\t if( !$('#file-uploader-widget div.progress-bar-danger').length){ \r\n    \t\t        $('#file-uploader-widget .progress-bar').css('width', progress + '%');\r\n    \t\t\t }\r\n    \t\t        \r\n    \t\t}).on('fileuploadfail',function (e, data) {\r\n    \t\t\t \r\n    \t\t\t$self.prependAertMessage(ap.core_prompts[\"message.Template.ErrorOccuredDuringUpload\"]);\r\n    \t\t\t\r\n    \t\t\t$(\"#file-uploader-widget \").prepend(message);\r\n  \r\n    \t\t}).on('fileuploaddone',function (e, data) {\r\n    \t\t\t\r\n    \t\t\t$self.resetFileuploadSection();\r\n    \t\t\t$('a[href=\"#turnstile-file-upload-status\"]').tab('show');\r\n    \t\t\t\r\n    \t\t}).on('fileuploaddragover',function (e, data){\r\n    \t\t\t// Tab is set to lit up to background color \r\n    \t\t\t$('#turnstile-files-selector').parent().addClass('drop-in'); \r\n    \t\t\t\r\n    \t\t});\r\n    \t\t\r\n    \t\t// Prevent drag & drop over document \r\n    \t\t$(document).bind('drop dragover', function (e) {\r\n    \t\t    e.preventDefault();\r\n    \t\t});\r\n    \t\t\r\n    \t\t// lit up drop zone.\r\n    \t\t\r\n    \t\t// turn off the lights when the user leaves the drop zone.\r\n    \t\t\r\n    \t\t$('#turnstile-files-selector').parent().on('dragleave drop', function (e) {\r\n    \t\t\t$('#turnstile-files-selector').parent().removeClass('drop-in'); \r\n    \t\t});\r\n    \t}\r\n    };\r\n\r\n    var resetAccountSearchModal = function ( accountSearchmanager ){\r\n    \t\r\n    \t$('#turnstile-account-selector button').removeAttr('disabled');\r\n\t\t$('#turnstile-account-search').addClass('hidden');\r\n\t\taccountSearchmanager.reset();\r\n    };\r\n    \r\n\t/**\r\n\t* Setup the file upload widget. Initialize the blueimp uploader.\r\n\t*/\r\n    this.setup = function (args) {\r\n\r\n        if (!args.length) {\r\n            ap.consoleError(ap.core_prompts[\"message.Template.UploadHandlerElementNotFound\"]);\r\n            return;\r\n        }\r\n\r\n        this.showUploadStatus();\r\n        \r\n    \tvar $self = this;\r\n\r\n    \t/*\r\n    \t * Event registry  \r\n    \t */ \r\n    \t$('#file-uploader-widget button[type=\"submit\"]').on('click', function(e){ $self.startUpload();}) ;\r\n    \t/*\r\n    \t * On Tab show, refresh the list of items.\r\n    \t */\r\n    \t$('a[href=\"#turnstile-file-upload-status\"]').on('show.bs.tab', function (e) { $self.showUploadStatus(); });\r\n\r\n    \t$('#turnstile-lob-selector button.continue').on('click', function(e){ $self.processLobSelection(); });\r\n    \t$('#turnstile-lob-selector button.cancel').on('click', function(e){ $self.cancelLobSelection(); });\r\n    \t\r\n     \r\n    \tvar tsSelectAccount =   function ( element, event  ) {\r\n\r\n\t\t\tvar accountId = element.closest('tr').attr('id').split('_')[1]; \r\n\t\t\t\r\n\t\t\tap.consoleInfo(\"Selected \"+accountId+\" account for turnstile attach\");\r\n\t\t\t\r\n\t\t\t$self.currentAccountId = accountId ; // Set up the current account selection. \r\n\t\t\t$self.createWorkItemsWithAccount($self.currentAccountId); \r\n\t\t\t$self.currentAccountId = null;\r\n    \t\r\n    \t };\r\n    \t\t \r\n    \t\r\n    \tvar accountSearchmanager = new ap.ModalAccountSearchManager('turnstile-account-search-input', 'turnstile-account-search-button', 'turnstile-account-search-results-listing',  tsSelectAccount );\r\n    \t\r\n    \t\r\n    \tthis.setupFileuploaderControls(args[0],args[1]);\r\n\t\r\n\t\t\r\n\t\t// Prevent drag & drop over document \r\n\t\t$(document).bind('drop dragover', function (e) {\r\n\t\t    e.preventDefault();\r\n\t\t});\r\n\t\t\r\n\t\t$('#turnstile-files-selector').parent().on('dragleave drop', function (e) {\r\n\t\t\t$('#turnstile-files-selector').parent().removeClass('drop-in'); \r\n\t\t});\r\n\t\t\t\r\n\t\t/*\r\n\t\t * Account Search toggle click - active and inactive state handling.\r\n\t\t */\r\n\t\t$('#turnstile-account-selector .account-search-button').on('click', function(e){\r\n\t\t\t\r\n\t\t\tif($(this).hasClass('active')){\r\n\t\t\t\tresetAccountSearchModal(accountSearchmanager);\r\n\t\t\t}else{\r\n\t\t\t\t$('#turnstile-account-search').removeClass('hidden'); \r\n\t\t\t\t$('#turnstile-account-selector button:not(.account-search-button,.close, #turnstile-account-search-button,.no-account,.new-account)').attr('disabled','disabled');\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t$('#turnstile-account-selector').on('show.bs.modal', function (e) {\r\n\t\t\t$('#turnstile-account-selector .account-search-button').removeClass('active');\r\n\t\t\tresetAccountSearchModal(accountSearchmanager);\r\n\t\t});\r\n\t\t\r\n\t\tif($('ul.get-started').length > 0){\t\t\t\r\n\t\t\t\r\n\t\t\t$('ul.get-started').on('shown.bs.dropdown', function (e) { \r\n\t\t\t\t$self.widgetOpen = true;\r\n\t\t\t\t$self.showUploadStatus(); \r\n\t\t\t\tap.consoleInfo('Get-Started:  Start Turnstile upload status update.');\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t$('ul.get-started').on('hidden.bs.dropdown', function (e) { \t\t\t\t\r\n\t\t\t\tap.consoleInfo('Get-Started: Stop Turnstile upload status update.');\r\n\t\t\t\t$self.widgetOpen = false;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$('#turnstile-upload-widget').on('show.bs.modal', function (e) {\r\n\t\t\t$self.widgetOpen = true;\r\n\t\t\t$self.showUploadStatus(); \r\n\t\t\tap.consoleInfo('Turnstile Widget is open. updating Turnstile upload status.');\r\n\t\t});\r\n\r\n\t\t$('#turnstile-upload-widget').on('hidden.bs.modal', function (e) {\r\n\t\t\t$self.widgetOpen = false;\r\n\t\t});\r\n\t};\r\n\t\r\n\r\n\tthis.deleteRow = function (element) {\r\n\t\tvar ix = $(element).index();\r\n\t\tthis.fileUploadData.files.splice(ix,1);\r\n\t\t$(element).remove();\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\t};\r\n\t\r\n\tthis.startUpload = function () {\r\n\t\t \r\n\t\t// get rid of any old messages\r\n\t\t$(\"#file-uploader-validation-message\").remove();\r\n\t\t\r\n\t\t// validate - at least one file is needed for uploads\r\n\t\tif(null === this.fileUploadData ||\t!this.fileUploadData.files.length){\r\n\t\t\tthis.prependAertMessage(ap.core_prompts[\"prompt.Template.SelectAFile\"]);\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// does any of the files have errors ?\r\n\t\tif (this.fileUploadData.files.filter( \r\n\t\t\t\tfunction (file) { return file.error; }).length ){\r\n\t\t\t\r\n\t\t\tthis.prependAertMessage(ap.core_prompts[\"prompt.Template.FixErrors\"]);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// disable the buttons before file transmission\r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", true);\r\n\t\t\r\n\t\tthis.fileUploadData.submit(); \r\n\t\t// enable the buttons back . \r\n\t\t$(\"#file-uploader-widget button\").attr(\"disabled\", false);\r\n\t};\r\n\t\r\n\t\r\n\t/**\r\n\t * Create work items and associate with <b>NEW</b> account \r\n\t * Account ID sent to back end is -1. \r\n\t */\r\n\tthis.createWorkItemsAndAccount = function(){\r\n    \t\r\n    \tvar $self = this;\r\n    \t\r\n    \t$self.addProgressIndicatorSpinner($('#turnstile-account-selector button.new-account'));\r\n    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t\r\n\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t}, '-1' );\r\n\t\t\t\t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create work itmes with account \r\n\t * @param accountId the account id that is used to associate the work items that are created.  \r\n\t */\r\n\tthis.createWorkItemsWithAccount = function(accountId){\r\n\r\n\t\tvar $self = this;\r\n     \r\n    \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t}, accountId );\r\n\t\t\r\n\t};\r\n\t\r\n\t\r\n\tthis.resetAccountModal = function () {\r\n\t\tthis.removeSpinnerControl($('#turnstile-account-selector button.new-account'));\r\n    \t$('#turnstile-account-selector button.account-search-button').removeClass('active');\r\n\t\t$('#turnstile_account_searchInput').val('');\r\n\t\t$('#turnstile-account-search').addClass('hidden');\r\n\t\t$('#turnstile-account-selector button').removeAttr(\"disabled\");\r\n\t\t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create work Items without accounts. \r\n\t */\r\n\tthis.continueWithoutAccount = function () {\r\n\t\t//Add a spinner .. \r\n\t\tvar $self = this;\r\n\t\t\r\n\t\t$self.addProgressIndicatorSpinner($('#turnstile-account-selector button.no-account'));\r\n    \t\r\n     \t$('#turnstile-account-selector button').attr(\"disabled\", \"disabled\");\r\n    \t\r\n\t\t// provide call back to hide the modal\r\n\t\tthis.createWorkItems(function(){ \r\n\t\t\t\t$self.resetAccountModal();\r\n\t\t\t\t$('#turnstile-account-selector').modal('hide');\r\n\t\t\t} );\r\n\t};\r\n\t\r\n\t/**\r\n\t * Create Workitems without an account. \r\n\t * GUID and Transaction list is retrieved from hidden LOB modal.\r\n\t * @param callback the call back function to be executed on done \r\n\t * @param accountId - the account ID to which the work items created are to be attached, \r\n\t * \t\t\taccountId -> undefined => createWorkitems without account\r\n\t * \t\t\taccountId -> -1        => Create a new Account and associate the work items to that account.\r\n\t * \t\t\taccountId -> ####      => Create new work items and attach to the account identified by account id.\r\n\t */\r\n\tthis.createWorkItems = function( callback , accountId){\r\n\t\t\r\n\t\tvar action = (accountId === undefined) ?  'createworkitems':'createworkitemsandaccount';\r\n\t\t\r\n\t\tvar accId = (accountId === undefined) ? '' : accountId ;\r\n\r\n\t\t$(\"#turnstile-processed-lob-listing\").html(\"\");\r\n\t\t$(\"#turnstile-processed-message\").html(\"\");\r\n\t\t\t\t\r\n\t\tvar guid = $('#turnstile-stage-guid').val();\r\n\t\tvar tranactions =  [];\r\n\t\t\r\n\t\tvar $self = this; \r\n\t \t\r\n\t\t$('input[name=\"transactions\"]:checked').map(function(){return tranactions.push(this.value);});\r\n\t\t\r\n\t       $.ajax({\r\n\t            type: \"POST\",\r\n\t            url: turnstileServiceURL,\r\n\t            dataType: \"JSON\",\r\n\t            data: {\r\n\t                'requestType': action,\r\n\t                'guid': guid,\r\n\t                'transactions': tranactions.join(\",\"),\r\n\t                'accountid':accId\r\n\t            }\r\n\t        }).done(function (msg) {\r\n\t        \t\r\n\t        \tif(callback && typeof callback === 'function' ){\r\n\t        \t\tcallback();\r\n\t        \t}\r\n\t        \t\r\n\t        \t$self.renderWorkitemsList(msg);\r\n\t        \t$self.showUploadStatus();\t        \t\r\n\t        }).fail(function (msg){\r\n\t        \t\r\n\t        \tif(callback && typeof callback === 'function' ){\r\n\t        \t\tcallback();\r\n\t        \t}\r\n\t        \t\r\n\t        \t$('#turnstile-error-modal .alert-danger').html(msg.responseJSON.message);\r\n\t        \t$('#turnstile-error-modal').modal('show');\r\n\t        \t\r\n\t        \t$self.showUploadStatus();\r\n\t        \t\r\n\t       });\r\n\t};\r\n\t\r\n\t/**\r\n\t * Render a work items list post the TS processing and creating the workitems in the system\r\n\t */\r\n\tthis.renderWorkitemsList = function ( msg ){\r\n    \t\r\n\t\tvar account = msg.workitems.filter( function (item ){ return item.lobCd === 'ACCOUNT';});\r\n\t\t\r\n\t\tif(account.length){\r\n\t\t\t\r\n\t\t\t$(\"#turnstile-processed-message\").append(\r\n\t\t\t\t\taccountMessageTemplate.split(\"{{accountName}}\").join(account[0].entityName + \" #\"+account[0].workitemid)\r\n\t\t\t\t\t\t\t\t\t\t  .split(\"{{url}}\").join(account[0].url)\r\n\t\t\t\t\t);\r\n\t\t}else{\r\n\t\t\t$(\"#turnstile-processed-message\").html(\"Your forms have been submitted successfully.\");\r\n\t\t}\r\n\t\t\r\n\t\tif($(\"#open-acct-button\") != null){\r\n\t\t\t$(\"#open-acct-button\").remove();\r\n\t\t}\r\n\t\tmsg.workitems.forEach( function (item) {\r\n    \t\t\r\n\t\t\tif( 'ACCOUNT' !=  item.lobCd) {\r\n\t\t\t\r\n\t    \t\tvar wiId = item.workitemid;\r\n\t    \t\tif(item.status ==='Error'){\r\n\t    \t\t\twiId = '<i class=\"fa fa-exclamation-triangle\" ></i>';\r\n\t    \t\t\t$(\"#turnstile-processed-lob-listing\").append(\r\n\t    \t\t\t\t\twiListRowTemplateError.split(\"{{workItemId}}\").join( wiId )\r\n\t        \t\t\t\t\t\t .split(\"{{lobTitle}}\").join(item.lobDesc)\r\n\t        \t\t\t\t\t\t .split(\"{{styleClass}}\").join(\"danger\")\r\n\t        \t\t\t\t\t\t .split(\"{{error}}\").join(item.message));\t    \r\n\t    \t\t}else{\r\n\t\t    \t\tvar url = '<a href=\"' + item.url +'\"' +  'class=\"btn btn-primary pull-right\"' + 'target=\"_self\" >' + ap.core_prompts[\"action.Open\"] + '</a>' ;  \t    \t\t\r\n\t    \t\t\t$(\"#turnstile-processed-lob-listing\").append(\r\n\t    \t\t\t\t\twiListRowTemplate.split(\"{{workItemId}}\").join( wiId )\r\n\t        \t\t\t\t\t\t .split(\"{{lobTitle}}\").join(item.lobDesc)\r\n\t        \t\t\t\t\t\t .split(\"{{styleClass}}\").join(\"\")\r\n\t        \t\t\t\t\t\t .split(\"{{url}}\").join(url));\t    \t\t\r\n\t    \t\t}\t    \t\t\r\n\t\t\t}\r\n    \t\t \r\n    \t});\r\n\r\n\t\t$(\"#turnstile-processed-lob-listing\").find('[data-toggle=\"popover\"]').each(function () {\r\n            $(this).popover('show');\r\n            $(this).popover('hide');\r\n        });\r\n\t\t\r\n\t\t$('#turnstile-workitem-selector').modal('show');\r\n\t\t\r\n\t\t$('body').on('click', function (e) {\r\n\t            $('[data-toggle=\"popover\"]').each(function () {\r\n\t                if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\r\n\t                    $(this).popover('hide');\r\n\t                }\r\n\t            });\r\n\t    });    \t\r\n\t};\r\n\t\r\n\t/**\r\n\t * Helper function to prepend alert messages for file upload.\r\n\t */\r\n\tthis.prependAertMessage = function(message) {\r\n\t\t$(\"#file-uploader-widget\").prepend( fileUploaderAlertdivTemplate.split(\"{{message}}\").join( message ) );\t\r\n\t};\r\n\t\r\n    this.setup(arguments);\r\n\r\n};\r\n\r\n\r\n$(function () {\r\n    ap.turnstileWidget = new ap.TurnstileWidget(\"fileupload_blueimp\",\"turnstile-files-selector\");\r\n});"]}